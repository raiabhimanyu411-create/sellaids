/*! For license information please see 9521.48ef8354.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[9521],{29521(e,r,s){s.r(r),s.d(r,{default:()=>m});var a=s(89379),t=s(65043),o=s(24974),n=s(79722),l=s(94651),i=s(35087),d=s(47874),c=s(23768),u=s(81035),p=s(70579);function m(){const{user:e,isAuthenticated:r,isUserLoading:s,login:m,logout:h}=(0,o.k)(),g=(0,d.Zp)(),[x,f]=(0,t.useState)({name:"",email:"",phone:"",address_line:"",city:"",state:"",pincode:"",currentPassword:"",newPassword:"",confirmPassword:""}),[w,b]=(0,t.useState)(!1),[y,v]=(0,t.useState)(!1),[j,N]=(0,t.useState)({current:!1,new:!1,confirm:!1}),P=(0,t.useRef)(null);(0,t.useEffect)(()=>{if(s)return;if(!r||null===e||void 0===e||!e.id)return c.oR.error("Please log in to view your profile [Error]",{duration:2500}),void g("/UserAuth/UserLogin",{replace:!0});const a="".concat("https://sellaids.com","/api/user/profile/list");n.A.get(a,{withCredentials:!0}).then(e=>{const r=e.data.data;f({name:r.name||r.full_name||"",email:r.email||"",phone:r.phone||"",address_line:r.address_line||"",city:r.city||"",state:r.state||"",pincode:r.pincode||"",currentPassword:"",newPassword:"",confirmPassword:""})}).catch(e=>{var r;401===(null===(r=e.response)||void 0===r?void 0:r.status)?(c.oR.error("Session expired. Please log in again [Error]",{duration:2500}),h(),g("/UserAuth/UserLogin",{replace:!0})):c.oR.error("Failed to load profile [Error]",{duration:2500})})},[r,e,s,g,h]);const A=e=>f((0,a.A)((0,a.A)({},x),{},{[e.target.name]:e.target.value}));(0,t.useEffect)(()=>{w&&setTimeout(()=>{var e;return null===(e=P.current)||void 0===e?void 0:e.focus()},0)},[w]);const C=e=>N(r=>(0,a.A)((0,a.A)({},r),{},{[e]:!r[e]}));return s?(0,p.jsx)("div",{className:"min-h-screen bg-gray-100 p-6",children:(0,p.jsx)("p",{className:"text-center mt-10",children:"Loading user..."})}):r&&null!==e&&void 0!==e&&e.id?(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{className:"max-w-3xl mx-auto bg-white p-8 rounded-xl shadow-md mt-10",children:[(0,p.jsx)("h1",{className:"text-3xl font-bold mb-6 text-gray-800",children:"My Profile"}),(0,p.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),v(!0);try{const e={name:x.name,phone:x.phone,address_line:x.address_line,city:x.city,state:x.state,pincode:x.pincode};let r=!1;if(x.currentPassword||x.newPassword||x.confirmPassword){if(x.newPassword!==x.confirmPassword)return c.oR.error("New passwords do not match! [Error]",{duration:2500}),void v(!1);e.currentPassword=x.currentPassword,e.newPassword=x.newPassword,e.confirmPassword=x.confirmPassword,r=!0}const s="".concat("https://sellaids.com","/api/user/profile/edit");await n.A.put(s,e,{withCredentials:!0,headers:{"Content-Type":"application/json"}});if(c.oR.success("Profile updated! [Success]",{duration:2500}),r){c.oR.success("Password changed! Logging out for security... [Lock]",{duration:3e3});try{await n.A.post("".concat("https://sellaids.com","/api/user/logout"),{},{withCredentials:!0})}catch(p){console.warn("Backend logout failed (continuing anyway):",p)}return h(),void g("/UserAuth/UserLogin",{replace:!0})}try{const e=await n.A.get("".concat("https://sellaids.com","/api/user/profile/list"),{withCredentials:!0});m(e.data.data)}catch(w){console.error("Failed to refresh updated profile",w)}b(!1),f(e=>(0,a.A)((0,a.A)({},e),{},{currentPassword:"",newPassword:"",confirmPassword:""})),g("/user")}catch(y){var r,s,t,o,l,i;if(401===(null===(r=y.response)||void 0===r?void 0:r.status))c.oR.error("Session expired. Logging out... [Error]",{duration:2500}),h(),g("/UserAuth/UserLogin",{replace:!0});else if("Current password is incorrect"===(null===(s=y.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.error))c.oR.error("Current password is wrong! [Error]",{duration:2500});else if(400===(null===(o=y.response)||void 0===o?void 0:o.status)&&null!==(l=y.response)&&void 0!==l&&null!==(i=l.data)&&void 0!==i&&i.errors){const e=Array.isArray(y.response.data.errors)?y.response.data.errors:y.response.data.errors.map(e=>e.msg);e.forEach(e=>c.oR.error(e+" [Error]",{duration:2500}))}else{var d,u;c.oR.error((null===(d=y.response)||void 0===d||null===(u=d.data)||void 0===u?void 0:u.message)||"Update failed [Error]",{duration:2500})}}finally{v(!1)}},className:"space-y-6",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),(0,p.jsx)("input",{type:"text",name:"name",ref:P,value:x.name,onChange:A,disabled:!w,placeholder:w?"Enter name":"",className:"w-full border rounded-lg p-3 focus:ring-2 focus:ring-red-500 focus:outline-none ".concat(w?"":"bg-gray-100 cursor-not-allowed")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,p.jsx)("input",{type:"email",value:x.email,disabled:!0,className:"w-full border rounded-lg p-3 bg-gray-100 cursor-not-allowed"})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),(0,p.jsx)("input",{type:"tel",name:"phone",value:x.phone,onChange:e=>{const r=e.target.value.replace(/\D/g,"").slice(0,10);f((0,a.A)((0,a.A)({},x),{},{phone:r}))},maxLength:10,disabled:!w,placeholder:w?"Enter phone":"",className:"w-full border rounded-lg p-3 focus:ring-2 focus:ring-red-500 focus:outline-none ".concat(w?"":"bg-gray-100 cursor-not-allowed")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),w?(0,p.jsxs)("div",{className:"space-y-3",children:[(0,p.jsx)("input",{name:"address_line",value:x.address_line,onChange:A,placeholder:"Address line",className:"w-full border rounded-lg p-3 focus:ring-2 focus:ring-red-500"}),(0,p.jsx)("input",{name:"city",value:x.city,onChange:A,placeholder:"City",className:"w-full border rounded-lg p-3 focus:ring-2 focus:ring-red-500"}),(0,p.jsx)("input",{name:"state",value:x.state,onChange:A,placeholder:"State",className:"w-full border rounded-lg p-3 focus:ring-2 focus:ring-red-500"}),(0,p.jsx)("input",{name:"pincode",value:x.pincode,onChange:e=>{const r=e.target.value.replace(/\D/g,"").slice(0,6);f((0,a.A)((0,a.A)({},x),{},{pincode:r}))},maxLength:6,placeholder:"Pincode",className:"w-full border rounded-lg p-3 focus:ring-2 focus:ring-red-500"})]}):(0,p.jsx)("div",{className:"w-full border rounded-lg p-3 bg-gray-100",children:(()=>{const{address_line:e,city:r,state:s,pincode:a}=x,t=[e,r,s,a].filter(Boolean);return t.length?t.join(", "):"Not provided"})()})]}),w&&(0,p.jsxs)("div",{className:"space-y-4",children:[(0,p.jsx)("h2",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"Change Password"}),(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),(0,p.jsx)("input",{type:j.current?"text":"password",name:"currentPassword",value:x.currentPassword,onChange:A,placeholder:"Current password",className:"w-full border rounded-lg p-3 pr-10 focus:ring-2 focus:ring-red-500"}),(0,p.jsx)("button",{type:"button",onClick:()=>C("current"),className:"absolute right-3 top-10 text-gray-600",children:j.current?(0,p.jsx)(l.A,{size:18}):(0,p.jsx)(i.A,{size:18})})]}),(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),(0,p.jsx)("input",{type:j.new?"text":"password",name:"newPassword",value:x.newPassword,onChange:A,placeholder:"New password",className:"w-full border rounded-lg p-3 pr-10 focus:ring-2 focus:ring-red-500"}),(0,p.jsx)("button",{type:"button",onClick:()=>C("new"),className:"absolute right-3 top-10 text-gray-600",children:j.new?(0,p.jsx)(l.A,{size:18}):(0,p.jsx)(i.A,{size:18})})]}),(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),(0,p.jsx)("input",{type:j.confirm?"text":"password",name:"confirmPassword",value:x.confirmPassword,onChange:A,placeholder:"Confirm new password",className:"w-full border rounded-lg p-3 pr-10 focus:ring-2 focus:ring-red-500"}),(0,p.jsx)("button",{type:"button",onClick:()=>C("confirm"),className:"absolute right-3 top-10 text-gray-600",children:j.confirm?(0,p.jsx)(l.A,{size:18}):(0,p.jsx)(i.A,{size:18})})]})]}),(0,p.jsx)("div",{className:"flex justify-end gap-3 mt-6",children:w?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("button",{type:"button",onClick:()=>{if(null!==e&&void 0!==e&&e.id){const e="".concat("https://sellaids.com","/api/user/profile/list");n.A.get(e,{withCredentials:!0}).then(e=>{const r=e.data.data;f({name:r.name||r.full_name||"",email:r.email||"",phone:r.phone||"",address_line:r.address_line||"",city:r.city||"",state:r.state||"",pincode:r.pincode||"",currentPassword:"",newPassword:"",confirmPassword:""})}).catch(()=>{})}b(!1)},className:"bg-gray-400 text-white px-6 py-3 rounded-lg hover:bg-gray-500",children:"Cancel"}),(0,p.jsx)("button",{type:"submit",disabled:y,className:"bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 disabled:opacity-50",children:y?"Saving...":"Save Changes"})]}):(0,p.jsx)("button",{type:"button",onClick:()=>b(!0),className:"bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700",children:"Edit Profile"})})]})]}),(0,p.jsx)("div",{className:"mt-8",children:(0,p.jsx)(u.A,{})})]}):null}},35087(e,r,s){s.d(r,{A:()=>a});const a=(0,s(77784).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},65469(e,r,s){s.d(r,{A:()=>a});const a=(0,s(77784).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},81035(e,r,s){s.d(r,{A:()=>o});s(65043);var a=s(65469),t=s(70579);const o=()=>(0,t.jsx)("div",{className:"mt-4 py-4 border-t border-gray-200 bg-gray-50",children:(0,t.jsx)("div",{className:"max-w-3xl mx-auto text-center",children:(0,t.jsxs)("button",{onClick:()=>{window.location.href="/"},className:"inline-flex items-center gap-2 text-gray-700 hover:text-red-600 font-medium text-lg transition-colors duration-200 group",children:[(0,t.jsx)(a.A,{size:20,className:"mr-2 group-hover:-translate-x-1 transition-transform"}),"Back to Website"]})})})},94651(e,r,s){s.d(r,{A:()=>a});const a=(0,s(77784).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])}}]);
//# sourceMappingURL=9521.48ef8354.chunk.js.map